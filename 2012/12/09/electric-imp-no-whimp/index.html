<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Electric Imp is no Whimp! | My blog</title>
    <meta name="description" content="Now this is a cute little devil. A wifi enabled micro controller in an SD package, with onboard support for various digital I/O. First I didn&#39;t quite get it, but after 10 minutes pondering I had an [E ...">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.9423e3c8.css" as="style"><link rel="preload" href="/assets/js/app.b86a8c6b.js" as="script"><link rel="preload" href="/assets/js/4.8c7e109f.js" as="script"><link rel="preload" href="/assets/js/5.a82a693a.js" as="script"><link rel="preload" href="/assets/js/18.06738c64.js" as="script"><link rel="prefetch" href="/assets/js/1.b12c199c.js"><link rel="prefetch" href="/assets/js/10.99a566dd.js"><link rel="prefetch" href="/assets/js/11.4574c3fd.js"><link rel="prefetch" href="/assets/js/12.404f5207.js"><link rel="prefetch" href="/assets/js/13.575b781d.js"><link rel="prefetch" href="/assets/js/14.4a6acc4a.js"><link rel="prefetch" href="/assets/js/15.47bab81b.js"><link rel="prefetch" href="/assets/js/16.d6661b68.js"><link rel="prefetch" href="/assets/js/17.b73a3007.js"><link rel="prefetch" href="/assets/js/19.28984759.js"><link rel="prefetch" href="/assets/js/20.3a105bd6.js"><link rel="prefetch" href="/assets/js/21.5e5ed2b7.js"><link rel="prefetch" href="/assets/js/22.1e721f97.js"><link rel="prefetch" href="/assets/js/23.bdc1b330.js"><link rel="prefetch" href="/assets/js/24.b1ecf9ff.js"><link rel="prefetch" href="/assets/js/6.16402cee.js"><link rel="prefetch" href="/assets/js/7.b2356e70.js"><link rel="prefetch" href="/assets/js/8.c845360f.js"><link rel="prefetch" href="/assets/js/9.d40b0488.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.b369032b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9423e3c8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">My blog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">My blog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><h1 class="post-title">The Electric Imp is no Whimp!</h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> 2012-12-09
  </div> <ul class="post-meta-tags"><li class="post-tag" data-v-d832e844><a href="/tag/development" data-v-d832e844> development </a></li></ul></div> <div class="content__default"><p>Now this is a cute little devil. A wifi enabled micro controller in an SD package, with onboard support for various digital I/O. First I didn't quite get it, but after 10 minutes pondering I had an <a href="https://www.google.com/search?q=light+bulb&amp;hl=sv&amp;client=safari&amp;tbo=u&amp;rls=en&amp;tbm=isch&amp;source=univ&amp;sa=X&amp;ei=9yTCUOqzOYe5hAfQ6YCQAQ&amp;sqi=2&amp;ved=0CDQQsAQ&amp;biw=1151&amp;bih=1088" target="_blank" rel="noopener noreferrer">Edison moment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and immediately ordered two more to toy with.</p> <p><img src="https://dl.dropbox.com/u/2932762/images/pWRL-11395l.jpg" alt="Electric imp"></p> <p><em>Bring Wifi to Everything</em> is the motto and with the imp it's easy to do so. Just create an account on <a href="http://electricimp.com" target="_blank" rel="noopener noreferrer">electricimp.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, put the imp in a break-out board for development (or a future ready-made thing that supports it), and power it up. First time you need to supply wifi login information and this is done with an as cute as clever solution; an iOS or Android app transfers the login information by blinking it's screen for a light sensor in the imp. As soon as it has the correct info, it will connect to the cloud service, update itself to latest firmware and pair with your account. Very neat!</p> <p>To program it you use the web based applications at <a href="http://electricimp.com" target="_blank" rel="noopener noreferrer">electricimp.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Basically, you write one program for each imp, deploy it on the hardware and optionally connects the input and output from the imp to ready-made software modules that electric imp provides.</p> <p>The system is still in early stage and there are not that many ready-made software modules yet. But it's easy to write your own software and the chosen language for the imp is Squirrel, which seems an excellent choice. It is powerful and shouldn't be hard to learn if you have some knowledge of C or C++.</p> <h2 id="first-project"><a href="#first-project" class="header-anchor">#</a> First project!</h2> <p>As always, I use my summer house as an excuse to test new things and I want to use the imp for remotely controlling the heating system so I can arrive to a warm and cosy cottage. The imp should enable remote control through a RESTful web service, and it shall log temperature and humidity to Cosm, or possibly to a database.</p> <p>The heating control only needs an open output pin that can sink/short circuit a loop in the thermostat that talks with the radiators. The code for this is very simple, I wrote this class:</p> <div class="language-squirrel extra-class"><pre class="language-text"><code>class SwitchInput extends InputPort {
    name = &quot;Heating switch&quot;;
    type = &quot;0 or 1&quot;;

    constructor() {
        base.constructor();
    
        // Configure pin 1 as an open drain output with internal pull up
        hardware.pin1.configure(DIGITAL_OUT_OD_PULLUP);
    }
 
    function set(value) {
        // Reflect state to the value = 1 should pull output low,
        // with switches radiators from &quot;away&quot; to &quot;at home&quot; mode. 
        hardware.pin1.write(value == 1 ? 0 : 1);
        server.show(value);
    }
}
~~~

Plus a few lines for instantiating the class and get the imp going. This defines an input to the imp and using the so called &quot;planner&quot; on electricimp.com I connected the input to a module for http. The module provides a unique URL over https for POSTing a switch value to the imp. When I have my sensor in place an output from the imp will be connected to [Cosm](http://cosm.com) for data logging. This is what the complete &quot;plan&quot; for  this imp will be:

![plan](https://dl.dropbox.com/u/2932762/images/planner.png)

The planner makes it drop-dead easy to connect your imp and it kindly reminds you to provide all needed information. In this case I haven't provided the API keys to Cosm yet.

My first idea was that temperature and humidity measurement should be done with an [RHT03 element](https://www.sparkfun.com/products/10167) which outputs readings with a single pin digital interface. It's a low cost device, easy to integrate, but it turned out that the imp is too slow for handling the sensor's digital interface. At least with the current implementation to sample input pins. So I scrapped that idea and will use an I2C-connected sensor instead. The imp has inbuilt support for I2C so that should be easy. I'll update this page when I get the new sensor.

Next up is writing an iPhone app that shows a graph of current temperature and humidity and gives you a handy way to toggle the heating between Home and Away mode.</code></pre></div></div> <!----> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#first-project" title="First project!">First project!</a></div></div></div></div> <footer class="footer" data-v-582f9766><div class="footer-left-wrap" data-v-582f9766><ul class="contact" data-v-582f9766><li class="contact-item" data-v-582f9766><a href="https://github.com/ejeklint" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-582f9766><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-582f9766></path></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="https://twitter.com/ejeklint" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter" data-v-582f9766><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" data-v-582f9766></path></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="https://instagram.com/ejeklint" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram" data-v-582f9766><rect x="2" y="2" width="20" height="20" rx="5" ry="5" data-v-582f9766></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" data-v-582f9766></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5" data-v-582f9766></line></svg>
          
        </a></li><li class="contact-item" data-v-582f9766><a href="mailto:per@ejeklint.se" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-582f9766><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-582f9766></path><polyline points="22,6 12,13 2,6" data-v-582f9766></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-582f9766><ul class="copyright" data-v-582f9766></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b86a8c6b.js" defer></script><script src="/assets/js/4.8c7e109f.js" defer></script><script src="/assets/js/5.a82a693a.js" defer></script><script src="/assets/js/18.06738c64.js" defer></script>
  </body>
</html>
